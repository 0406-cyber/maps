import folium
import pandas as pd

# ---------------------------------------------------------
# [1] ì—¬ê¸°ì— ë°©ë¬¸í•  ì¥ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì—‘ì…€ì´ë‚˜ CSV í•„ìš” ì—†ìŒ)
# ---------------------------------------------------------
data = [
    {"name": "í”„ë¼í•˜ ê³µí•­", "lat": 50.1018, "lon": 14.2632},
    {"name": "ìˆ™ì†Œ (í˜¸í…”)", "lat": 50.0880, "lon": 14.4208},
]

# ---------------------------------------------------------
# [2] ì§€ë„ ë§Œë“¤ê¸° (êµ¬ê¸€ë§µ ìŠ¤íƒ€ì¼ ì ìš©)
# ---------------------------------------------------------
# ì¤‘ì‹¬ì  ì¡ê¸°
start_lat = data[0]['lat']
start_lon = data[0]['lon']

# ì§€ë„ ìƒì„± (í™•ëŒ€/ì¶•ì†Œ ë¨)
m = folium.Map(location=[start_lat, start_lon], zoom_start=13, tiles=None)

# êµ¬ê¸€ ë§µ íƒ€ì¼ ì”Œìš°ê¸°
folium.TileLayer(
    tiles='http://mt0.google.com/vt/lyrs=m&hl=ko&x={x}&y={y}&z={z}',
    attr='Google',
    name='Google Maps',
    overlay=False,
    control=True
).add_to(m)

# ---------------------------------------------------------
# [3] ë§ˆì»¤ì™€ ì„  ê·¸ë¦¬ê¸°
# ---------------------------------------------------------
points = []
for i, loc in enumerate(data):
    # ë§ˆì»¤
    folium.Marker(
        [loc['lat'], loc['lon']],
        popup=loc['name'],
        tooltip=f"{i+1}. {loc['name']}",
        icon=folium.Icon(color='red', icon='info-sign')
    ).add_to(m)
    points.append([loc['lat'], loc['lon']])

# ê²½ë¡œ ì„  ê¸‹ê¸°
for i in range(len(points)-1):
    p1 = points[i]
    p2 = points[i+1]
    
    # êµ¬ê¸€ë§µ ê¸¸ì°¾ê¸° ë§í¬
    g_url = f"https://www.google.com/maps/dir/?api=1&origin={p1[0]},{p1[1]}&destination={p2[0]},{p2[1]}&travelmode=transit"
    
    html = f'''
    <div style="font-family: sans-serif; text-align: center; width: 120px;">
        <p style="margin: 5px 0; font-weight: bold;">{data[i]['name']} â†’ {data[i+1]['name']}</p>
        <a href="{g_url}" target="_blank" style="display: block; background-color: #4285F4; color: white; padding: 6px; text-decoration: none; border-radius: 4px; font-size: 12px;">
            ğŸšŒ ê¸¸ì°¾ê¸° í´ë¦­
        </a>
    </div>
    '''
    
    folium.PolyLine(
        locations=[p1, p2],
        color="#4285F4",
        weight=5,
        opacity=0.8,
        popup=folium.Popup(html, max_width=200)
    ).add_to(m)

# ---------------------------------------------------------
# [4] íŒŒì¼ë¡œ ì €ì¥ (í•µì‹¬!)
# ---------------------------------------------------------
m.save("index.html")
print("ì§€ë„ íŒŒì¼(index.html)ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤! GitHubì— ì˜¬ë¦¬ì„¸ìš”.")
